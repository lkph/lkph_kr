require 'csv'

input_file = '_data/books_import_data.tsv'

# Robust reading similar to clean_tsv.rb
raw_content = File.read(input_file, encoding: 'utf-8')
lines = raw_content.split("\n").map(&:strip).reject(&:empty?)
clean_raw = lines.join("\n")

table = CSV.parse(clean_raw, col_sep: "\t", headers: true)
header = table.headers

# Data for "김범준의 물리 장난감"
isbn = '979-11-89680-54-1'

book_intro = <<~TEXT
물리학자 김범준이 알려주는 장난감 속 물리 이야기<br><br>베스트셀러 『세상물정의 물리학』과 유튜브 「과학을 보다」, 「범준에 물리다」로 많은 사랑을 받는 물리학자 김범준 교수의 책 『김범준의 물리 장난감』이 새로 나왔다. 김범준 교수는 장난감을 수집하는 남다른 취미가 있다. 그에게 장난감은 귀여운 수집품인 동시에 눈으로 직접 확인하며 물리 법칙을 깨칠 수 있는 훌륭한 교육 도구다. 오랜 시간 모아온 그의 다채로운 장난감 컬렉션이 『김범준의 물리 장난감』을 통해 세상에 공개된다. 누구나 책을 읽다 보면 신기한 장난감들을 구경하는 재미와 함께, 어렵고 딱딱하게만 느껴졌던 물리학 원리도 자연스레 익힐 수 있게 된다. 책장을 덮을 때쯤이면 나만의 물리 장난감 컬렉션을 만들고 있을지도 모른다.
TEXT

toc = <<~TEXT
PART 1 힘 겨루고 운동하는 물리 장난감<br><br>1. 아슬아슬한 평형의 비밀: 무게 중심과 중심 잡는 새 013<br>2. 무거운 공이 가벼운 공을 밀어내면?: 탄성 로켓과 운동량 보존 법칙 022<br>3. 내가 회전하는 건 추진력을 얻기 위해서다: 각운동량과 팽이 039<br>4. 처음엔 어렵지만 계속하기는 쉬운 이유: 마찰력과 게이지 블록 050<br>5. 물과 공기의 엄청난 힘: 압력과 마그데부르크의 반구 061<br>6. 압력과 중력의 균형으로 탁구공 띄우기: 베르누이의 원리와 분무기 073<br>7. 가장 효율적이고 튼튼한 다리를 만드는 법: 현수선의 역학적 평형과 광안대교 079<br>8. 직선이 가장 빨리 가는 길은 아니다: 최단시간 곡선과 구르는 바퀴 092<br>[물리 장난감 DIY] 중력과 부력이 만들어 내는 하모니 : 부력과 물고기 잠수함 103<br><br>PART 2 열과 에너지를 운반하는 물리 장난감<br><br>9. 보이지 않는 에너지를 찾는 법: 에너지 보존 법칙과 뉴턴의 진자 177<br>10. 동전이 세로로 서지 않는 이유: 에너지 바닥 상태와 마술 주사위 127<br>11. 작은 응결핵의 파급 효과: 과냉각과 액체 주머니 손난로 135<br>12. 온도와 압력과 부피의 단순하고도 복잡한 관계: 열팽창과 핸드 보일러 144<br>13. 물에 젖으면 몸이 차가워지는 이유: 기화열과 물 마시는 새 152<br>14. 온도 차로 만들어 내는 친환경 에너지: 열역학 법칙과 스털링 엔진 160<br>[물리 장난감 DIY] 무거우면 떠오르는 이상한 세상: 낟알계와 브라질너트 효과 171<br><br>PART 3 보고 듣고 느끼는 물리 장난감<br><br>15. 빛은 가장 빠른 길을 알고 있다: 최소 시간의 원리와 개구리 알 187<br>16. 마술 아닌 물리 법칙으로 공중 부양하기: 정상파와 음파 부양기 202<br>17. 모래알로 그림을 그리는 파동의 비밀: 공명과 두피 마사지기 216<br>18, 웅덩이에는 왜 무지개가 나타날까: 빛의 간섭·회절과 DVD 디스크 228<br>19. 언제 어디서나 일식을 관찰하는 법: 일식과 바늘구멍 사진기 240<br>20. 로또 당첨자 수로 판매량을 추측할 수 있다?: 확률·통계와 골턴 보드 248<br>21. 100년 동안의 실험: 물질의 상태와 퍼티 260<br>[물리 장난감 DIY] 껌 종이로 전기 회로 만들기: 전기 저항과 껌 종이 실험 267<br><br>SPECIAL 놀이공원의 거대 장난감에 숨은 물리: 퍼텐셜 에너지와 롤러코스터, 전자기 유도와 자이로드롭
TEXT

excerpt = <<~TEXT
| 들어가며<br><br>장난감을 통해 경이로운 세상 속으로!<br><br>저는 대학교에서 물리학을 가르칩니다. 두꺼운 물리 교과서에는 참 많은 내용이 들어 있어요. 사람들이 두려워하는 수식도 잔뜩 담겨 있죠. 가르치고 배워야 할 게 너무 많아서 대학교 물리학 수업은 정말 숨 가쁘게 진행됩니다. 화이트보드에 계속 이어지는 수식 계산에 지친 학생이 잠깐 눈길을 돌려 창문 밖을 바라봅니다. 파란 하늘에 뜬 흰 뭉게구름이 정말 아름다워 보입니다.<br><br>하늘이 왜 파란지, 하늘에 떠 있는 구름은 왜 떨어지지 않는지, 물리학은 수학의 모습을 띤 이론으로 자연 현상을 설명합니다. 하지만 수업에서 마주친 내용을 이해하려 애쓰는 학생은 방금 본 수식 자체에 정신을 빼앗깁니다. 그리고 바로 그 수식이 강의실 창밖의 구름 속 작은 물방울 얘기라는 것을 눈치채지 못합니다. <br><br>공기 중 물체의 낙하를 수식으로 설명할 때, 파란 하늘과 흰 구름, 그리고 그 속에서 떨어지는 물방울을 바라보며 물리를 감각할 수 있을까요? 저는 물리학 이론을 수식으로 설명하면서, 학생들이 그 현상을 직접 눈으로 보고 이해할 수 있기를 오래전부터 소망했습니다.<br><br>그래서 물리 원리가 적용된 간단한 장난감들을 모으기 시작했습니다. 너무 비싸거나 너무 커서 강의실에 가지고 가기 어려운 것들은 빼고요. 원래 물리 장난감으로 만들어진 것은 아니지만, 물리학의 원리를 보여줄 수 있는 작은 물건도 여럿 모았죠. 그날 수업 내용에 딱 맞춰 가져간 장난감을 교탁 위에 올려놓고 수업을 시작하면, 이제나저제나 제가 언제 그 장난감을 보여줄까 기대하며 학생들이 호기심 가득한 눈으로 수업에 집중하더라고요. 그렇게 하나, 둘, 셋, 제가 가진 물리 장난감이 조금씩 조금씩 늘어났습니다.<br><br>2020년 여름, 저의 물리학 장난감 컬렉션으로 작은 전시를 열었습니다. 그때 오신 분들이 장난감을 직접 만져도 보고 제 얘기도 재밌게 들어 주셨어요. 물론, 장난감 자랑도 하고 그 배경이 되는 물리학 얘기를 하는 제가 더 행복했죠. 이 책은 바로 그 전시회에서 시작되었습니다. 다시 한 번 당시 전시회를 멋지게 기획하고 진행한 도서출판 이김의 김미선 님께 깊은 고마움을 전합니다. 이후 네이버 프리미엄 콘텐츠 채널에 『김범준의 물리장난감』 연재를 시작했고, 그 글들이 모이고 수정, 보완을 거쳐 이제 책으로 엮여 나옵니다. 연재한 내용을 책으로 출판하는 것을 양해해 주신 네이버에도 감사드립니다. 제 유튜브 채널 ‘범준에 물리다’에서도 실험 동영상을 준비하고 있으니 지켜봐 주세요. 제가 쓰면서 그랬듯, 여러분도 재밌게 이 책을 읽어 주시기를 바랍니다.<br><br>우리 일상, 여러분 바로 곁에도 신기하고 재미있는 물리 현상이 많습니다. 너무 익숙해서 한 번도 깊게 생각해 보지 않았어도, 물리학으로 이해하고 설명할 수 있는 것이 제법 많아요. 너무나 익숙해서 늘 당연하게 생각했던 현상을 물리학으로 설명할 수 있음을 깨달을 때 저는 등골이 오싹한 경이로움을 여전히 느낍니다. 세상도 경이롭고 물리학도 경이롭습니다. 이처럼 경이로운 물리학을 만들어 낸 우리 인간도 참 경이롭습니다.
TEXT

publisher_review = <<~TEXT
“우와! 세상이 온통 물리로 가득해!”<br><br>★ 물리요정 김범준 교수님이 소중하게 모아 둔 장난감 대 공개<br>★ 알쓸신잡 물리학자 김상욱 교수님 추천<br>★ 귀엽고 신기한 장난감으로 쉽게 알아보는 물리의 원리<br><br>물리(物理)라는 단어에 복잡해지는 사람도 있겠지만 물리는 ‘우리 세상이 돌아가는 원리’다. 따라서 물리 법칙은 세상 어디에나 있다. 하지만 그 법칙은 눈으로 볼 수 없어서 물리학자들은 수식과 그래프와 그림으로 물리학을 표현했다. 물리를 눈으로 보고 체험할 다른 방법은 없을까? 물리학자 김범준 교수는 고민 끝에 답을 찾았다. 바로 장난감이다.<br><br>사실 처음부터 물리 장난감을 수집하려던 건 아니었다. 그저 재미있고 신기한 장난감이 눈에 띌 때마다 하나둘 사 모았을 뿐인데 어느새 연구실 곳곳에 장난감이 쌓여갔다. 수업에도 장난감을 활용하니 학생들의 흥미를 끌고 수업 집중도도 높아졌다. 그렇게 모인 장난감으로 작은 전시도 열었다. 장난감 속에 들어 있는 물리 원리를 좀더 간단하게 이해할 수 있도록 설명하기로 마음먹었고, 그 결과물이 바로 이 책 『김범준의 물리 장난감』이다.<br><br>이 책은 고전역학부터 열역학, 전자기학 등 물리학의 세부 분야를 폭넓게 아우르며 물리학의 기본 개념을 눈에 보이도록 풀어냈다. 신기한 장난감들을 구경하며 놀이하듯 책을 읽어가다 보면 자연스럽게 물리학 원리를 터득하게 된다. 경희대학교 물리학과 김상욱 교수는 "김범준 교수님은 물리 장난감의 원리를 쉽지만 제대로 설명해 준다"며 "원리를 다 이해하지 못해도 괜찮다. 그저 물리 장난감의 신비한 매력에 푹 빠져 보라"고 권했다.<br><br>이 책은 단순히 물리학 지식을 말하는 데 그치지 않는다. 이 책의 가장 큰 목적은 물리학의 경이로움과 아름다움을 전하는 것이다. 물리 법칙은 실제로 이 세상을 지배하는, 이 세상의 모든 것에 적용되는 근본 원리이자, 인류가 오랜 세월 동안 터득해 온 지혜다. 귀여운 장난감을 통해 그 경이로움을 발견하는 것은 세상을 새롭게 바라보는 눈을 얻는 일이기도 하다.<br><br>김범준 교수는 물리학도로서, 그리고 한 인간으로서 장난감을 모으고 관찰하는 과정을 진솔하게 들려준다. 호기심에서 시작된 작은 움직임이 어떻게 책 한 권으로 결실을 맺게 되었는지, 그 열정의 과정이 고스란히 담겨있다. 그리고 자신만의 물리 장난감을 만드는 방법도 알려준다.<br><br>독자들은 이 책을 통해 과학하는 즐거움과 세상을 탐구하는 흥미를 만끽할 수 있을 것이다. 물리가 어렵고 잘 모른다고 생각하는 사람이라도 충분히 물리의 매력에 빠질 수 있다. 책장을 덮을 때쯤이면 나만의 물리 장난감 컬렉션을 만들고 있을지도 모른다.
TEXT

author_intro = <<~TEXT
성균관대학교 물리학과에서 물리를 가르치고 있습니다. 서울대학교 물리학과를 졸업하고 같은 대학원에서 초전도 배열에 관한 이론 연구로 박사 학위를 받았습니다. 과학을 진심으로 사랑하고 물리학자의 눈으로 세상과 사람을 바라보는 것을 좋아해, 『세상물정의 물리학』, 『관계의 과학』, 『보이지 않아도 존재하고 있습니다』 등 다수의 베스트셀러를 썼고, 유튜브 채널 “범준에 물리다”를 운영하며 과학의 즐거움을 알리는 커뮤니케이터 역할을 하고 있습니다.
TEXT

updated = false
rows = []
table.each do |row|
  if row['ISBN'] == isbn
    row['제목'] = '김범준의 물리 장난감'
    row['부가기호'] = '03420'
    row['부제'] = '일상 속 사물들에서 찾은 신기한 과학 원리'
    row['저자'] = '김범준'
    row['임프린트'] = '이김'
    row['출간일'] = '2024-05-20'
    row['정가'] = '22,000'
    row['가로'] = '145'
    row['세로'] = '210'
    row['페이지수'] = '288'
    row['책 소개'] = book_intro.strip
    row['목차'] = toc.strip
    row['출판사 서평'] = publisher_review.strip
    row['저자 소개'] = author_intro.strip
    row['본문 인용'] = excerpt.strip
    updated = true
  end
  rows << row
end

if updated
  File.open(input_file, "w", encoding: 'utf-8') do |f|
    f.puts header.to_csv(col_sep: "\t")
    rows.each do |row|
      f.puts row.to_csv(col_sep: "\t")
    end
  end
  puts "Updated data for Physics Toys (ISBN: #{isbn})."
else
  puts "ISBN #{isbn} not found."
end
